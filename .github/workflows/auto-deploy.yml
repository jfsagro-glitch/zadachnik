name: üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π CURSOR Pipeline Demo

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  workflow_dispatch:

jobs:
  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
  test:
    runs-on: ubuntu-latest
    name: üß™ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    
    steps:
    - name: üì• Checkout –∫–æ–¥–∞
      uses: actions/checkout@v4
      
    - name: üì¶ Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
      run: npm ci
      
    - name: üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
      run: npm run quick-test
      
    - name: üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
      run: npm test

  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –Ω–∞ GitHub Pages
  deploy-pages:
    needs: test
    runs-on: ubuntu-latest
    name: üåê –î–µ–ø–ª–æ–π –Ω–∞ GitHub Pages
    
    steps:
    - name: üì• Checkout –∫–æ–¥–∞
      uses: actions/checkout@v4
      
    - name: üì¶ Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
      run: npm ci
      
    - name: üèóÔ∏è –°–±–æ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π –≤–µ—Ä—Å–∏–∏
      run: |
        mkdir -p dist
        cp -r public/* dist/
        cp LAUNCH.html dist/index.html
        
    - name: üöÄ –î–µ–ø–ª–æ–π –Ω–∞ GitHub Pages
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./dist
        cname: jfsagro-glitch.github.io

  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ Codespace
  create-codespace:
    needs: test
    runs-on: ubuntu-latest
    name: ‚òÅÔ∏è –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ Codespace
    
    steps:
    - name: üì• Checkout –∫–æ–¥–∞
      uses: actions/checkout@v4
      
    - name: üìù –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ README —Å —Å—Å—ã–ª–∫–æ–π –Ω–∞ Codespace
      run: |
        echo "## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫" >> README.md
        echo "" >> README.md
        echo "### ‚ö° –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –≤ Codespaces" >> README.md
        echo "" >> README.md
        echo "[![Open in GitHub Codespaces](https://github.com/codespaces/badge.svg)](https://github.com/codespaces/new?hide_repo_select=true&ref=main&repo=jfsagro-glitch%2Fzadachnik)" >> README.md
        echo "" >> README.md
        echo "**–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –±–µ–π–¥–∂ –≤—ã—à–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞!**" >> README.md
        
    - name: üíæ Commit –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ README
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git add README.md
        git commit -m "ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ Codespace" || exit 0
        git push || exit 0

  # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
  notify:
    needs: [test, deploy-pages, create-codespace]
    runs-on: ubuntu-latest
    name: üì¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    
    steps:
    - name: ‚úÖ –£—Å–ø–µ—à–Ω—ã–π –¥–µ–ø–ª–æ–π
      run: |
        echo "üéâ CURSOR Pipeline Demo —É—Å–ø–µ—à–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç!"
        echo "üåê GitHub Pages: https://jfsagro-glitch.github.io/zadachnik/"
        echo "‚òÅÔ∏è GitHub Codespaces: https://github.com/codespaces/new?repo=jfsagro-glitch/zadachnik"
        echo "üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://github.com/jfsagro-glitch/zadachnik/blob/main/README.md"
